<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>
<?import com.skilora.framework.components.*?>

<VBox xmlns="http://javafx.com/javafx"
      xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.skilora.finance.controller.EmployeurFinanceController"
      styleClass="app-content-wrapper" spacing="0"
      style="-fx-background-color: -fx-background;">

    <!-- TOP HEADER BAR -->
    <HBox styleClass="app-topbar" spacing="16" alignment="CENTER_LEFT">
        <Label text="ðŸ‘¤ Ma Paie - Espace Employeur" style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: -fx-foreground;"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Label text="ðŸ”’ Mode Consultation Personnelle" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 13px; -fx-font-weight: bold;"/>
        <TLButton text="ðŸ”„ RafraÃ®chir Tout" variant="OUTLINE" onAction="#handleRefreshAll"/>
    </HBox>

    <!-- SALARY SUMMARY CARDS -->
    <HBox spacing="16" style="-fx-padding: 16; -fx-background-color: -fx-background;">
        <VBox spacing="4" HBox.hgrow="ALWAYS" style="-fx-background-color: -fx-card; -fx-padding: 16; -fx-border-radius: 8; -fx-background-radius: 8; -fx-border-color: -fx-border; -fx-border-width: 1;">
            <Label text="ðŸ‘¤ EmployÃ©" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 12px;"/>
            <Label fx:id="summary_employeeName" text="..." style="-fx-text-fill: -fx-foreground; -fx-font-size: 18px; -fx-font-weight: bold;"/>
        </VBox>
        <VBox spacing="4" HBox.hgrow="ALWAYS" style="-fx-background-color: -fx-card; -fx-padding: 16; -fx-border-radius: 8; -fx-background-radius: 8; -fx-border-color: -fx-border; -fx-border-width: 1;">
            <Label text="ðŸ’° Salaire Actuel" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 12px;"/>
            <Label fx:id="summary_currentSalary" text="0.00 TND" style="-fx-text-fill: -fx-foreground; -fx-font-size: 18px; -fx-font-weight: bold;"/>
        </VBox>
        <VBox spacing="4" HBox.hgrow="ALWAYS" style="-fx-background-color: -fx-card; -fx-padding: 16; -fx-border-radius: 8; -fx-background-radius: 8; -fx-border-color: -fx-border; -fx-border-width: 1;">
            <Label text="ðŸŽ Total Primes" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 12px;"/>
            <Label fx:id="summary_totalBonuses" text="0.00 TND" style="-fx-text-fill: -fx-foreground; -fx-font-size: 18px; -fx-font-weight: bold;"/>
        </VBox>
        <VBox spacing="4" HBox.hgrow="ALWAYS" style="-fx-background-color: -fx-card; -fx-padding: 16; -fx-border-radius: 8; -fx-background-radius: 8; -fx-border-color: -fx-border; -fx-border-width: 1;">
            <Label text="ðŸ“‹ CNSS" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 12px;"/>
            <Label fx:id="summary_cnssDeduction" text="0.00 TND" style="-fx-text-fill: -fx-foreground; -fx-font-size: 18px; -fx-font-weight: bold;"/>
        </VBox>
        <VBox spacing="4" HBox.hgrow="ALWAYS" style="-fx-background-color: -fx-card; -fx-padding: 16; -fx-border-radius: 8; -fx-background-radius: 8; -fx-border-color: -fx-border; -fx-border-width: 1;">
            <Label text="ðŸ“‹ IRPP" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 12px;"/>
            <Label fx:id="summary_irppTax" text="0.00 TND" style="-fx-text-fill: -fx-foreground; -fx-font-size: 18px; -fx-font-weight: bold;"/>
        </VBox>
        <VBox spacing="4" HBox.hgrow="ALWAYS" style="-fx-background-color: -fx-card; -fx-padding: 16; -fx-border-radius: 8; -fx-background-radius: 8; -fx-border-color: -fx-border; -fx-border-width: 1;">
            <Label text="âœ… Net" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 12px;"/>
            <Label fx:id="summary_netSalary" text="0.00 TND" style="-fx-text-fill: -fx-foreground; -fx-font-size: 18px; -fx-font-weight: bold;"/>
        </VBox>
    </HBox>

    <!-- TABBED INTERFACE (READ-ONLY, PERSONAL) -->
    <TabPane VBox.vgrow="ALWAYS" tabClosingPolicy="UNAVAILABLE" style="-fx-background-color: -fx-background;">

        <!-- TAB 1: MY SALARY DETAILS -->
        <Tab text="ðŸ’° DÃ©tail Salaire" closable="false">
            <VBox spacing="12" style="-fx-padding: 16; -fx-background-color: -fx-background;" VBox.vgrow="ALWAYS">
                <Label text="ðŸ“Š DÃ©tail complet du calcul de votre paie (CNSS, IRPP, Net)" style="-fx-text-fill: -fx-foreground; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                <TextArea fx:id="taxBreakdownArea" promptText="Le dÃ©tail de votre paie s'affichera ici..." wrapText="true" prefRowCount="20" VBox.vgrow="ALWAYS" editable="false"
                          style="-fx-control-inner-background: -fx-muted; -fx-text-fill: -fx-foreground; -fx-font-size: 14px; -fx-font-family: 'Consolas', 'Monospaced'; -fx-padding: 12px; -fx-border-color: -fx-border; -fx-border-radius: 4; -fx-background-radius: 4;"/>
            </VBox>
        </Tab>

        <!-- TAB 2: MY CONTRACTS -->
        <Tab text="ðŸ“‹ Mes Contrats" closable="false">
            <VBox spacing="12" style="-fx-padding: 16; -fx-background-color: -fx-background;">
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <Label text="ðŸ“‹ Vos contrats de travail" style="-fx-text-fill: -fx-foreground; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <TLButton text="ðŸ”„ RafraÃ®chir" variant="OUTLINE" onAction="#handleRefreshContracts"/>
                    <Label fx:id="my_contract_countLabel" text="Total: 0" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 14px;"/>
                </HBox>
                <TableView fx:id="myContractTable" VBox.vgrow="ALWAYS" editable="false" style="-fx-background-color: -fx-card;">
                    <columns>
                        <TableColumn fx:id="my_contract_idCol" text="ID" prefWidth="50" visible="false"/>
                        <TableColumn fx:id="my_contract_companyCol" text="SociÃ©tÃ©" prefWidth="100"/>
                        <TableColumn fx:id="my_contract_typeCol" text="Type" prefWidth="120"/>
                        <TableColumn fx:id="my_contract_positionCol" text="Poste" prefWidth="180"/>
                        <TableColumn fx:id="my_contract_salaryCol" text="Salaire (TND)" prefWidth="140"/>
                        <TableColumn fx:id="my_contract_startCol" text="Date DÃ©but" prefWidth="120"/>
                        <TableColumn fx:id="my_contract_endCol" text="Date Fin" prefWidth="120"/>
                        <TableColumn fx:id="my_contract_statusCol" text="Statut" prefWidth="100"/>
                    </columns>
                </TableView>
            </VBox>
        </Tab>

        <!-- TAB 3: MY BANK ACCOUNTS -->
        <Tab text="ðŸ¦ Mes Comptes" closable="false">
            <VBox spacing="12" style="-fx-padding: 16; -fx-background-color: -fx-background;">
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <Label text="ðŸ¦ Vos comptes bancaires enregistrÃ©s" style="-fx-text-fill: -fx-foreground; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <TLButton text="ðŸ”„ RafraÃ®chir" variant="OUTLINE" onAction="#handleRefreshBankAccounts"/>
                    <Label fx:id="my_bank_countLabel" text="Total: 0" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 14px;"/>
                </HBox>
                <TableView fx:id="myBankTable" VBox.vgrow="ALWAYS" editable="false" style="-fx-background-color: -fx-card;">
                    <columns>
                        <TableColumn fx:id="my_bank_idCol" text="ID" prefWidth="50" visible="false"/>
                        <TableColumn fx:id="my_bank_nameCol" text="Banque" prefWidth="180"/>
                        <TableColumn fx:id="my_bank_ibanCol" text="IBAN" prefWidth="200"/>
                        <TableColumn fx:id="my_bank_swiftCol" text="SWIFT" prefWidth="120"/>
                        <TableColumn fx:id="my_bank_currencyCol" text="Devise" prefWidth="100"/>
                        <TableColumn fx:id="my_bank_primaryCol" text="Principal" prefWidth="90"/>
                        <TableColumn fx:id="my_bank_verifiedCol" text="VÃ©rifiÃ©" prefWidth="90"/>
                    </columns>
                </TableView>
            </VBox>
        </Tab>

        <!-- TAB 4: MY BONUSES -->
        <Tab text="ðŸŽ Mes Primes" closable="false">
            <VBox spacing="12" style="-fx-padding: 16; -fx-background-color: -fx-background;">
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <Label text="ðŸŽ Vos primes et bonus" style="-fx-text-fill: -fx-foreground; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <TLButton text="ðŸ”„ RafraÃ®chir" variant="OUTLINE" onAction="#handleRefreshBonuses"/>
                    <Label fx:id="my_bonus_countLabel" text="Total: 0" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 14px;"/>
                </HBox>
                <TableView fx:id="myBonusTable" VBox.vgrow="ALWAYS" editable="false" style="-fx-background-color: -fx-card;">
                    <columns>
                        <TableColumn fx:id="my_bonus_idCol" text="ID" prefWidth="60" visible="false"/>
                        <TableColumn fx:id="my_bonus_amountCol" text="Montant (TND)" prefWidth="180"/>
                        <TableColumn fx:id="my_bonus_reasonCol" text="Motif" prefWidth="350"/>
                        <TableColumn fx:id="my_bonus_dateCol" text="Date" prefWidth="180"/>
                    </columns>
                </TableView>
            </VBox>
        </Tab>

        <!-- TAB 5: MY PAYSLIPS -->
        <Tab text="ðŸ“„ Mes Bulletins" closable="false">
            <VBox spacing="12" style="-fx-padding: 16; -fx-background-color: -fx-background;">
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <Label text="ðŸ“„ Historique de vos bulletins de paie" style="-fx-text-fill: -fx-foreground; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <TLButton text="ðŸ”„ RafraÃ®chir" variant="OUTLINE" onAction="#handleRefreshPayslips"/>
                    <Label fx:id="my_payslip_countLabel" text="Total: 0" style="-fx-text-fill: -fx-muted-foreground; -fx-font-size: 14px;"/>
                </HBox>
                <TableView fx:id="myPayslipTable" VBox.vgrow="ALWAYS" editable="false" style="-fx-background-color: -fx-card;">
                    <columns>
                        <TableColumn fx:id="my_payslip_idCol" text="ID" prefWidth="50" visible="false"/>
                        <TableColumn fx:id="my_payslip_periodCol" text="PÃ©riode" prefWidth="120"/>
                        <TableColumn fx:id="my_payslip_baseCol" text="Base" prefWidth="120"/>
                        <TableColumn fx:id="my_payslip_overtimeCol" text="H. Supp." prefWidth="120"/>
                        <TableColumn fx:id="my_payslip_bonusCol" text="Primes" prefWidth="120"/>
                        <TableColumn fx:id="my_payslip_grossCol" text="Brut" prefWidth="120"/>
                        <TableColumn fx:id="my_payslip_deductCol" text="DÃ©ductions" prefWidth="120"/>
                        <TableColumn fx:id="my_payslip_netCol" text="Net" prefWidth="120"/>
                        <TableColumn fx:id="my_payslip_statusCol" text="Statut" prefWidth="100"/>
                    </columns>
                </TableView>
            </VBox>
        </Tab>

    </TabPane>

</VBox>
